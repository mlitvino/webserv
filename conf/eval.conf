# Comprehensive Webserv Configuration Test
# This configuration tests all requirements systematically

# Server 1 - Main server on port 8080 with localhost
server {
	listen 8080;
	server_name localhost;
	client_max_body_size 100;  # Very small for testing body limit (100 bytes)
	
	# Custom error pages
	error_page 404 web/www/errors/custom_404.html;
	error_page 500 web/www/errors/custom_500.html;
	error_page 403 web/www/errors/403.html;
	
	# Root location with limited methods
	location / {
		root ./web/www;
		index index.html index.htm;
		allow_methods GET HEAD;
		autoindex on;
	}
	
	# Upload area with specific methods
	location /upload {
		root ./web/upload;
		allow_methods GET POST DELETE;
		autoindex on;
	}
	
	# API location with different directory
	location /api {
		root ./web/www/api;
		index api.html index.html;
		allow_methods GET POST PUT;
		autoindex off;
	}
	
	# CGI scripts
	location /cgi-bin {
		root ./web/cgi-bin;
		allow_methods GET POST;
		cgi python;
		autoindex off;
	}
	
	# Test location for method restrictions
	location /restricted {
		root ./web/www/restricted;
		allow_methods GET;  # Only GET allowed
		autoindex on;
	}
}

# Server 2 - Different port (8081)
server {
	listen 8081;
	server_name localhost dev.localhost;
	client_max_body_size 1024;  # 1KB limit
	
	error_page 404 web/www/errors/404.html;
	error_page 500 web/www/errors/500.html;
	
	location / {
		root ./web/www;
		index index.html;
		allow_methods GET POST DELETE PUT HEAD;
		autoindex on;
	}
	
	location /dev {
		root ./web/www;
		index index.html;
		allow_methods GET POST;
		autoindex on;
	}
}

# Server 3 - Different hostname (example.com)
server {
	listen 8080;
	server_name example.com www.example.com;
	client_max_body_size 2048;  # 2KB limit
	
	error_page 404 web/www/errors/404.html;
	
	location / {
		root ./web/www;
		index about.html index.html;  # Different default file
		allow_methods GET HEAD;
		autoindex on;
	}
	
	location /test {
		root ./web/www/test;
		allow_methods GET POST DELETE;
		autoindex on;
	}
}

# Server 4 - Another different hostname (test.local)
server {
	listen 8082;
	server_name test.local api.test.local;
	client_max_body_size 512;  # 512 bytes limit
	
	location / {
		root ./web/www;
		index index.html;
		allow_methods GET;
		autoindex on;
	}
}
